<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Top Up Game - RHF GAMES</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="utils.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0b1220;
  color:#fff;
}
.header{
  display:flex;
  align-items:center;
  gap:12px;
  padding:16px;
  background:#020617;
}
.header img{
  width:48px;
  height:48px;
  border-radius:12px;
}
.section{
  margin:16px;
  padding:16px;
  background:#0f172a;
  border-radius:16px;
  border:1px solid #1e293b;
}
.section h3{
  margin:0 0 12px;
  font-size:16px;
}
.input-group input{
  width:100%;
  padding:14px;
  border-radius:10px;
  border:none;
  background:#020617;
  color:#fff;
  font-size:15px;
}
.hint{
  margin-top:6px;
  font-size:12px;
  color:#94a3b8;
}
.products{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.product{
  padding:14px;
  border-radius:14px;
  border:1px solid #1e293b;
  background:#020617;
  cursor:pointer;
}
.product.active{
  border:2px solid #22d3ee;
  background:#020617;
}
.product h4{
  margin:0;
  font-size:14px;
}
.product p{
  margin:6px 0 0;
  color:#22d3ee;
  font-weight:bold;
}
.checkout{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#020617;
  padding:14px;
}
.checkout button{
  width:100%;
  padding:16px;
  background:#22c55e;
  border:none;
  border-radius:14px;
  font-size:16px;
  font-weight:bold;
}
</style>
</head>

<body>

<div class="header">
  <img src="https://i.imgur.com/6XK4J7y.png">
  <div>
    <b id="gameName">Game</b><br>
    <small>Top Up Resmi & Otomatis</small>
  </div>
</div>

<div class="section">
  <h3>Masukkan Data Akun</h3>
  <div class="input-group">
    <input id="userInput" placeholder="Masukkan ID">
    <div class="hint" id="inputHint">Contoh: 12345678(1234)</div>
  </div>
</div>

<div class="section">
  <h3>Pilih Nominal</h3>
  <div class="products" id="productList"></div>
</div>

<div class="checkout">
  <button onclick="checkout()">Lanjut ke Pembayaran</button>
</div>

<script>
const params=new URLSearchParams(location.search);
const id=params.get("id");

const games=JSON.parse(localStorage.getItem("rhf_products"))||[];
const game=games.find(g=>g.id==id);
if(!game){location.href="index.html";}

document.getElementById("gameName").innerText=game.name;

if(game.name.toLowerCase().includes("mobile legends")){
  userInput.placeholder="12345678(1234)";
  inputHint.innerText="User ID (Server)";
}

let selected=null;
const list=document.getElementById("productList");

[
 {name:"86 Diamonds",base:1000},
 {name:"172 Diamonds",base:2000},
 {name:"257 Diamonds",base:3000},
 {name:"514 Diamonds",base:5000}
].forEach(p=>{
  const price=RHF_UTILS.getSellPrice(p.base);
  const div=document.createElement("div");
  div.className="product";
  div.innerHTML=`<h4>${p.name}</h4><p>${RHF_UTILS.formatRupiah(price)}</p>`;
  div.onclick=()=>{
    document.querySelectorAll(".product").forEach(x=>x.classList.remove("active"));
    div.classList.add("active");
    selected={...p,price};
  };
  list.appendChild(div);
});

function checkout(){
  if(!userInput.value) return alert("Masukkan data akun");
  if(!selected) return alert("Pilih nominal");

  const orders=JSON.parse(localStorage.getItem("rhf_orders"))||[];
  orders.push({
    invoice:RHF_UTILS.generateInvoice(),
    product:game.name+" "+selected.name,
    userInput:userInput.value,
    total:selected.price
  });
  localStorage.setItem("rhf_orders",JSON.stringify(orders));
  location.href="checkout.html";
}
</script>

</body>
</html>
