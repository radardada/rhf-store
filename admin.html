<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin Dashboard | RHF Store</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="bg-light">
  <div class="container mt-5">
    <!-- Form Login Admin (Awalnya Muncul) -->
    <div id="login-section" class="card mx-auto" style="max-width: 400px;">
      <div class="card-body text-center">
        <h3 class="mb-4">Login Admin</h3>
        <img src="https://img.icons8.com/color/96/000000/lock.png" alt="Secure Login" class="mb-4"> <!-- Icon lock -->
        <form id="admin-login-form">
          <div class="mb-3">
            <input type="text" id="admin-username" class="form-control" placeholder="Username (default: admin)" required>
          </div>
          <div class="mb-3">
            <input type="password" id="admin-password" class="form-control" placeholder="Password" required>
          </div>
          <button type="submit" class="btn btn-primary w-100">Login</button>
          <p class="mt-3 small text-muted">Default password: rhfadmin2025 (ganti di kode JS)</p>
        </form>
      </div>
    </div>

    <!-- Dashboard Admin (Awalnya Hidden) -->
    <div id="dashboard-section" style="display: none;">
      <div class="d-flex">
        <!-- Sidebar & Main Content sama seperti sebelumnya -->
        <div class="sidebar p-4 bg-dark text-white">
          <h4 class="text-center mb-4">Admin Panel</h4>
          <a href="#products" class="d-block text-white mb-2">Produk</a>
          <a href="#orders" class="d-block text-white mb-2">Orders</a>
          <a href="#users" class="d-block text-white mb-2">Users</a>
          <button class="btn btn-danger w-100 mt-4" onclick="logoutAdmin()">Logout</button>
        </div>

        <div class="flex-grow-1 p-5">
          <h1 class="mb-5">Dashboard Admin</h1>
          <!-- Form Tambah Produk & Table sama seperti kode sebelumnya -->
          <!-- ... (paste bagian form & table dari kode admin lama mu) ... -->
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module">
    import { fetchProducts, addProduct, deleteProduct, fetchOrders, fetchUsers, formatRupiah } from './utils.js';

    // Password Admin (Ganti ini kalau mau ubah password!)
    const ADMIN_USERNAME = 'admin';
    const ADMIN_PASSWORD_HASH = '6eb732bd9f897ba5cc25f8e7dcd3dbc6753f9ed08f54e6980aafd2c1cc34de71'; // Hash dari "rhfadmin2025" (pakai tool online SHA-256)

    // Fungsi hash password (SHA-256 aman)
    async function hashPassword(password) {
      const encoder = new TextEncoder();
      const data = encoder.encode(password);
      const hash = await crypto.subtle.digest('SHA-256', data);
      return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
    }

    // Handle Login
    document.getElementById('admin-login-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const username = document.getElementById('admin-username').value.trim();
      const password = document.getElementById('admin-password').value;

      if (username !== ADMIN_USERNAME) {
        alert('Username salah!');
        return;
      }

      const hashed = await hashPassword(password);
      if (hashed === ADMIN_PASSWORD_HASH) {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('dashboard-section').style.display = 'block';
        loadAdminData(); // Load table produk dll
        alert('Login berhasil! Selamat datang admin.');
      } else {
        alert('Password salah! Coba lagi.');
      }
    });

    // Logout
    window.logoutAdmin = () => {
      document.getElementById('login-section').style.display = 'block';
      document.getElementById('dashboard-section').style.display = 'none';
    };

    // loadAdminData(), addProduct handle, dll â†’ Paste dari kode admin sebelumnya
    // Pastikan ada loadAdminData() seperti sebelumnya untuk refresh table setelah tambah produk

    async function loadAdminData() {
      // Kode load table produk, orders, users sama seperti sebelumnya
      // Tambah try-catch kalau perlu
    }
  </script>
</body>
</html>
