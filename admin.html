<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RHF ADMIN PANEL</title>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#020617;
  color:#fff;
}
header{
  padding:14px;
  background:#020617;
  border-bottom:1px solid #1e293b;
}
section{
  padding:14px;
}
.box{
  background:#020617;
  border:1px solid #1e293b;
  border-radius:12px;
  padding:14px;
  margin-bottom:14px;
}
input,select{
  width:100%;
  padding:8px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #1e293b;
  background:#020617;
  color:#fff;
}
button{
  margin-top:8px;
  padding:8px 12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
}
.green{background:#22c55e;color:#000}
.red{background:#ef4444;color:#fff}
.blue{background:#38bdf8;color:#000}
.list{
  display:grid;
  gap:8px;
}
.item{
  border:1px solid #1e293b;
  border-radius:10px;
  padding:10px;
}
.hidden{display:none}
small{color:#94a3b8}
</style>
</head>

<body>

<header>
  <b>RHF ADMIN PANEL</b>
</header>

<section>

<!-- BARANG -->
<div class="box">
<h3>Tambah Barang</h3>
<input id="gGame" placeholder="Game">
<input id="gName" placeholder="Nama Item">
<input id="gPrice" type="number" placeholder="Harga">
<input id="gImg" placeholder="Link Gambar">
<button class="green" onclick="addItem()">TAMBAH</button>
</div>

<div class="box">
<h3>Daftar Barang</h3>
<div id="itemList" class="list"></div>
</div>

<!-- VOUCHER -->
<div class="box">
<h3>Buat Voucher</h3>
<input id="vCode" placeholder="Kode Voucher">
<input id="vDisc" type="number" placeholder="Diskon %">
<input id="vMax" type="number" placeholder="Maks Pemakai">
<input id="vDays" type="number" placeholder="Aktif (hari)">
<button class="blue" onclick="addVoucher()">BUAT VOUCHER</button>
</div>

<div class="box">
<h3>Voucher Aktif</h3>
<div id="voucherList" class="list"></div>
</div>

<!-- AKUN -->
<div class="box">
<h3>Buat Akun Pembeli</h3>
<input id="uUser" placeholder="Username">
<input id="uPass" placeholder="Password">
<button class="green" onclick="addUser()">SIMPAN AKUN</button>
<button onclick="openAccounts()">LIHAT AKUN</button>
</div>

</section>

<!-- HALAMAN AKUN -->
<div id="accountsPage" class="hidden">
<section>
<h3>Daftar Akun</h3>
<div id="userList" class="list"></div>
<button class="red" onclick="closeAccounts()">TUTUP</button>
</section>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyAyHSaALeuwibcF22VNL_6WDlcZepcDB3A",
  databaseURL: "https://rhf-gamestore-default-rtdb.asia-southeast1.firebase.app"
});
const db=firebase.database();

// BARANG
function addItem(){
  db.ref("items").push({
    game:gGame.value,
    name:gName.value,
    price:Number(gPrice.value),
    img:gImg.value
  });
  gGame.value=gName.value=gPrice.value=gImg.value="";
}

db.ref("items").on("value",snap=>{
  itemList.innerHTML="";
  snap.forEach(s=>{
    const d=s.val();
    itemList.innerHTML+=`
      <div class="item">
        <b>${d.name}</b><br>
        Rp ${d.price.toLocaleString("id-ID")}<br>
        <button class="red" onclick="delItem('${s.key}')">HAPUS</button>
      </div>
    `;
  });
});

function delItem(id){
  db.ref("items/"+id).remove();
}

// VOUCHER
function addVoucher(){
  const exp=Date.now()+Number(vDays.value)*86400000;
  db.ref("vouchers/"+vCode.value).set({
    diskon:Number(vDisc.value),
    max:Number(vMax.value),
    used:0,
    expire:exp,
    aktif:true
  });
}

db.ref("vouchers").on("value",snap=>{
  voucherList.innerHTML="";
  snap.forEach(s=>{
    const v=s.val();
    voucherList.innerHTML+=`
      <div class="item">
        <b>${s.key}</b><br>
        Diskon ${v.diskon}%<br>
        Used ${v.used}/${v.max}<br>
        <button onclick="toggleVoucher('${s.key}',${v.aktif})">
          ${v.aktif?"NONAKTIF":"AKTIFKAN"}
        </button>
      </div>
    `;
  });
});

function toggleVoucher(k,s){
  db.ref("vouchers/"+k+"/aktif").set(!s);
}

// AKUN
function addUser(){
  db.ref("users").push({
    user:uUser.value,
    pass:uPass.value,
    status:"active"
  });
  uUser.value=uPass.value="";
}

function openAccounts(){
  accountsPage.classList.remove("hidden");
}

function closeAccounts(){
  accountsPage.classList.add("hidden");
}

db.ref("users").on("value",snap=>{
  userList.innerHTML="";
  snap.forEach(s=>{
    const u=s.val();
    userList.innerHTML+=`
      <div class="item">
        <b>${u.user}</b><br>
        Status: ${u.status}<br>
        <button onclick="toggleUser('${s.key}','${u.status}')">
          ${u.status==="active"?"BLOKIR":"AKTIFKAN"}
        </button>
      </div>
    `;
  });
});

function toggleUser(id,st){
  db.ref("users/"+id+"/status").set(st==="active"?"blocked":"active");
}
</script>

</body>
</html>
