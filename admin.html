<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ADMIN RHF GAME STORE</title>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#020617;
  color:#fff;
  padding:14px;
}
h2{margin-top:24px}
.box{
  background:#020617;
  border:1px solid #1e293b;
  border-radius:12px;
  padding:14px;
  margin-bottom:16px;
}
input,select,button{
  width:100%;
  padding:8px;
  margin-top:6px;
  border-radius:8px;
  border:none;
}
input,select{
  background:#020617;
  color:#fff;
  border:1px solid #1e293b;
}
button{
  background:#22c55e;
  color:#000;
  font-weight:bold;
  cursor:pointer;
}
.red{background:#ef4444;color:#fff}
.item{border-bottom:1px solid #1e293b;padding:6px 0}
small{color:#94a3b8}
</style>
</head>

<body>

<h1>ADMIN PANEL RHF</h1>
<small>Kontrol penuh item, akun, voucher (real-time)</small>

<!-- ITEM -->
<div class="box">
<h2>Tambah Item</h2>
<input id="igame" placeholder="Nama Game">
<input id="iname" placeholder="Nama Item">
<input id="iprice" placeholder="Harga (angka)">
<input id="iimg" placeholder="Link Gambar (https://i.imgur.com/...)">
<button onclick="addItem()">SIMPAN ITEM</button>
</div>

<div class="box">
<h2>Daftar Item</h2>
<div id="itemList"></div>
</div>

<!-- USER -->
<div class="box">
<h2>Buat Akun Pembeli</h2>
<input id="uuser" placeholder="Username">
<input id="upass" placeholder="Password">
<button onclick="addUser()">BUAT AKUN</button>
</div>

<div class="box">
<h2>Daftar Akun</h2>
<div id="userList"></div>
</div>

<!-- VOUCHER -->
<div class="box">
<h2>Buat Voucher</h2>
<input id="vkode" placeholder="Kode Voucher (contoh: RHF50)">
<input id="vdiskon" placeholder="Diskon % (contoh: 10)">
<select id="vaktif">
  <option value="true">Aktif</option>
  <option value="false">Nonaktif</option>
</select>
<button onclick="addVoucher()">SIMPAN VOUCHER</button>
</div>

<div class="box">
<h2>Daftar Voucher</h2>
<div id="voucherList"></div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyAyHSaALeuwibcF22VNL_6WDlcZepcDB3A",
  databaseURL: "https://rhf-gamestore-default-rtdb.asia-southeast1.firebasedatabase.app"
});

const db = firebase.database();

/* ================= ITEM ================= */
function addItem(){
  if(!igame.value||!iname.value||!iprice.value) return alert("Lengkapi data");
  db.ref("items").push({
    game: igame.value,
    name: iname.value,
    price: Number(iprice.value),
    img: iimg.value
  });
  igame.value=iname.value=iprice.value=iimg.value="";
}

db.ref("items").on("value", s=>{
  itemList.innerHTML="";
  s.forEach(x=>{
    const d=x.val();
    itemList.innerHTML+=`
    <div class="item">
      <b>${d.game}</b> - ${d.name}<br>
      Rp ${Number(d.price).toLocaleString("id-ID")}<br>
      <button class="red" onclick="del('items','${x.key}')">HAPUS</button>
    </div>`;
  });
});

/* ================= USER ================= */
function addUser(){
  if(!uuser.value||!upass.value) return alert("Lengkapi");
  db.ref("users").push({
    user:uuser.value,
    pass:upass.value,
    status:"active"
  });
  uuser.value=upass.value="";
}

db.ref("users").on("value", s=>{
  userList.innerHTML="";
  s.forEach(x=>{
    const d=x.val();
    userList.innerHTML+=`
    <div class="item">
      <b>${d.user}</b> (${d.status})<br>
      <button onclick="setStatus('${x.key}','active')">AKTIF</button>
      <button class="red" onclick="setStatus('${x.key}','blocked')">BLOKIR</button>
    </div>`;
  });
});

function setStatus(id,val){
  db.ref("users/"+id+"/status").set(val);
}

/* ================= VOUCHER ================= */
function addVoucher(){
  if(!vkode.value||!vdiskon.value) return alert("Lengkapi");
  db.ref("vouchers/"+vkode.value).set({
    diskon:Number(vdiskon.value),
    aktif:vaktif.value==="true"
  });
  vkode.value=vdiskon.value="";
}

db.ref("vouchers").on("value", s=>{
  voucherList.innerHTML="";
  s.forEach(x=>{
    const d=x.val();
    voucherList.innerHTML+=`
    <div class="item">
      <b>${x.key}</b> - ${d.diskon}% (${d.aktif?"AKTIF":"OFF"})<br>
      <button onclick="toggleVoucher('${x.key}',${!d.aktif})">TOGGLE</button>
      <button class="red" onclick="del('vouchers','${x.key}')">HAPUS</button>
    </div>`;
  });
});

/* ================= UTIL ================= */
function del(path,id){
  if(confirm("Yakin hapus?")) db.ref(path+"/"+id).remove();
}
function toggleVoucher(k,v){
  db.ref("vouchers/"+k+"/aktif").set(v);
}
</script>

</body>
</html>
